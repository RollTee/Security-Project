{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/doark/Documents/githubs/Security-Project/src/app/front/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faCloudUploadAlt,faCheckCircle } from '@fortawesome/free-solid-svg-icons';\r\n\r\n\r\nexport default function Home() {\r\n    const [images, setImages] = useState<any[]>([]);\r\n    const [uploadTime, setUploadTime] = useState<number | null>(null);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [showRecent, setShowRecent] = useState(false);\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    useEffect(() => {\r\n        fetch(\"http://localhost:3030/\")\r\n            .then((res) => res.json())\r\n            .then((data) => setImages(data))\r\n            .catch(() => setError(\"Failed to fetch images\"));\r\n    }, []);\r\n\r\n    const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n        const file = e.dataTransfer.files[0];\r\n        if (file) setSelectedFile(file);\r\n    };\r\n\r\n    const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {\r\n        e.preventDefault();\r\n        setIsDragging(true);\r\n    };\r\n\r\n    const handleDragLeave = () => {\r\n        setIsDragging(false);\r\n    };\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) setSelectedFile(file);\r\n    };\r\n\r\n    const handleClickBrowse = () => {\r\n        fileInputRef.current?.click();\r\n    };\r\n\r\n    const handleUpload = async () => {\r\n        if (!selectedFile) return;\r\n\r\n        const formData = new FormData();\r\n        formData.append(\"file\", selectedFile);\r\n        const startTime = performance.now();\r\n\r\n        try {\r\n            const response = await fetch(\"http://localhost:3030/upload\", {\r\n                method: \"POST\",\r\n                body: formData,\r\n            });\r\n\r\n            if (!response.ok) throw new Error(\"Upload failed\");\r\n\r\n            const endTime = performance.now();\r\n            setUploadTime(endTime - startTime);\r\n\r\n            const updatedImages = await fetch(\"http://localhost:3030/\").then((res) => res.json());\r\n            setImages(updatedImages);\r\n            setError(null);\r\n            setSelectedFile(null);\r\n            setShowRecent(true);\r\n\r\n            // Auto hide the recent section after 5 seconds\r\n            setTimeout(() => setShowRecent(false), 5000);\r\n        } catch {\r\n            setError(\"Failed to upload image\");\r\n        }\r\n    };\r\n\r\n    const handleDownload = (imageID: number) => {\r\n        window.location.href = `http://localhost:3030/download/${imageID}`;\r\n    };\r\n\r\n    const recentImage = images[images.length - 1];\r\n\r\n    return (\r\n        <div className=\"bg-gray-200 min-h-screen flex flex-col items-center\">\r\n            {/* Header */}\r\n            <header className=\"w-full bg-gray-300 p-6 flex justify-between items-center\">\r\n                <div className=\"text-4xl font-bold text-black\">Logo</div>\r\n                <nav className=\"space-x-4\">\r\n                    <a href=\"/front\" className=\"text-xl text-black\">Upload</a>\r\n                    <a href=\"#\" className=\"text-xl text-black\">All images</a>\r\n                </nav>\r\n            </header>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"flex flex-col items-center mt-8 w-full px-4\">\r\n                <div className=\"bg-white p-15 rounded-lg shadow-md w-full max-w-lg\">\r\n                <h1 className=\"text-2xl font-bold text-center mb-4 text-black\">Please upload image to encryption</h1>\r\n                    <div\r\n                        className={`border-2 border-dashed p-12 mb-4 flex flex-col items-center justify-center rounded transition-all ${\r\n                            isDragging ? \"border-green-500 bg-green-50\" : \"border-black\"\r\n                        }`}\r\n                        onDrop={handleDrop}\r\n                        onDragOver={handleDragOver}\r\n                        onDragLeave={handleDragLeave}\r\n                    >\r\n                            <FontAwesomeIcon icon={faCloudUploadAlt} className=\"text-4xl mb-4 text-black\" />\r\n                            <p className=\"mb-4 text-black\">Choose a file or drag & drop it here</p>\r\n                            <button\r\n                            type=\"button\"\r\n                            onClick={handleClickBrowse}\r\n                            className=\"bg-gray-200 text-black py-2 px-4 rounded\"\r\n                            >\r\n                                Browse File\r\n                            </button>\r\n                        \r\n                        <input\r\n                            type=\"file\"\r\n                            accept=\"image/*\"\r\n                            ref={fileInputRef}\r\n                            onChange={handleFileChange}\r\n                            className=\"hidden\"\r\n                        />\r\n                        {selectedFile && (\r\n                            <p className=\"mt-4 text-sm text-green-600\">\r\n                                Selected: {selectedFile.name}\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={handleUpload}\r\n                        disabled={!selectedFile}\r\n                        className={`w-full py-2 px-4 rounded text-white ${\r\n                            selectedFile ? \"bg-green-500 hover:bg-green-600\" : \"bg-gray-400 cursor-not-allowed\"\r\n                        }`}\r\n                    >\r\n                        Upload\r\n                    </button>\r\n\r\n                    {uploadTime && (\r\n                        <p className=\"text-green-600 text-center mt-2\">\r\n                            Uploaded in {uploadTime.toFixed(2)} ms\r\n                        </p>\r\n                    )}\r\n                    {error && (\r\n                        <p className=\"text-red-600 text-center mt-2\">{error}</p>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Recent Upload with fade-in/fade-out animation */}\r\n                {recentImage && (\r\n                    <div\r\n                        className={`fixed inset-0 flex items-center justify-center transition-opacity duration-700 ease-in-out transform ${\r\n                            showRecent ? \"opacity-100 translate-y-0\" : \"opacity-0 -translate-y-4 pointer-events-none\"\r\n                        }`}\r\n                    >\r\n                        {/* Background overlay with blur and semi-transparent effect */}\r\n                        <div className=\"absolute inset-0  bg-opacity-50 backdrop-blur-sm\"></div>\r\n\r\n                        {/* Modal content */}\r\n                        <div className=\"bg-white p-4 rounded-lg shadow-md w-full max-w-lg relative z-10 border-2 border-green-500\">\r\n                            <button\r\n                                onClick={() => setShowRecent(false)}\r\n                                className=\"absolute top-2 right-2 text-gray-500 hover:text-gray-700\"\r\n                            >\r\n                                ✕\r\n                            </button>\r\n                            <h2 className=\"text-xl font-bold mb-4 text-black text-center\">Recent Upload</h2>\r\n                            <div className=\"flex items-center justify-between bg-gray-100 p-4 rounded\">\r\n                                <div className=\"flex items-center\">\r\n                                    <FontAwesomeIcon icon={faCheckCircle} className=\"text-green-500 text-2xl mr-4\" />\r\n                                    <div>\r\n                                        <p>{recentImage.name || `Image ID ${recentImage.id}`}</p>\r\n                                        <p className=\"text-gray-500 text-sm\">上传成功 - Completed</p>\r\n                                    </div>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => handleDownload(recentImage.id)}\r\n                                    className=\"text-sm bg-blue-500 text-white px-3 py-1 rounded\"\r\n                                >\r\n                                    Download\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n                {/* View All Images Button */}\r\n                <button className=\"bg-green-500 text-white py-2 px-4 rounded mt-8\">\r\n                    Click to see all images\r\n                </button>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}